%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% MATH COMMANDS                                                              %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Matrix
% @see http://tex.stackexchange.com/questions/199789/which-bold-style-is-recommended-for-matrix-notation
% Undergraduate algebra version
%\newcommand{\matr}[1]{\mathbf{#1}}
% Pure math version
%\newcommand{\matr}[1]{#1}
% ISO complying version
\DeclareDocumentCommand{\matr}{m}{%
  \bm{#1}%
}

% Vector
\DeclareDocumentCommand{\vect}{m}{%
%  \vec{#1}%
  \bm{#1}%
}

% Absolute value
% \abs{x} renders |x|
\DeclareDocumentCommand{\abs}{m}{%
  \vert {#1} \vert%
}

% Norm
% \norm{a_i} renders || a_i ||_2 
% \norm[1]{a_i} renders || a_i ||_1
\DeclareDocumentCommand{\norm}{o m}{%
  \IfNoValueTF{#1}{%
    \left\Vert {#2} \right\Vert
  }{%
    \left\Vert {#2} \right\Vert_{\smaller[2]{#1}}
  }
}

% Power
% \pow{x} renders x^2
% \pow[3]{x} renders x^3
\DeclareDocumentCommand{\pow}{O{2} m}{%
  {#2}^{#1}%
}

% Skew-symmetric matrix
% \skewm{x} renders x with a tilde on it
\DeclareDocumentCommand{\skewm}{m}{%
  \left[ #1 \right]_{\times}
}

% Diagonal
% \diag renders diag for a matrix as diagonal of the elements
\DeclareMathOperator{\diag}{diag}

% Differential operator (upface d)
\DeclareMathOperator{\dif}{d \!}
% Derivative operator (upface D)
\DeclareMathOperator{\Dif}{D \!}

% Command for partial derivatives. The first argument denotes the function and the second argument denotes the variable with respect to which the derivative is taken. The optional argument denotes the order of differentiation. The style (text style/display style) is determined automatically
\providecommand{\pd}[3][]{%
\ifinner%
  \tfrac{\partial{^{#1}}#2}{\partial{#3^{#1}}}%
\else%
  \dfrac{\partial{^{#1}}#2}{\partial{#3^{#1}}}%
\fi%
}


% \tpd[2]{f}{k} denotes the second partial derivative of f with respect to k
% The first letter t means "text style"
\providecommand{\tpd}[3][]{\mathinner{%
  \tfrac{\partial{^{#1}}#2}{\partial{#3^{#1}}}%
}}%
% \dpd[2]{f}{k} denotes the second partial derivative of f with respect to k
% The first letter d means "display style"
\providecommand{\dpd}[3][]{\mathinner{%
  \dfrac{\partial{^{#1}}#2}{\partial{#3^{#1}}}%
}}%

% mixed derivative - analogous to the partial derivative command
% \md{f}{5}{x}{2}{y}{3}
\providecommand{\md}[6]{%
\ifinner%
  \tfrac{\partial{^{#2}}#1}{\partial{#3^{#4}}\partial{#5^{#6}}}%
\else%
  \dfrac{\partial{^{#2}}#1}{\partial{#3^{#4}}\partial{#5^{#6}}}%
\fi%
}%

% \tpd[2]{f}{k} denotes the second partial derivative of f with respect to k
% The first letter t means "text style"
\providecommand{\tmd}[6]{\mathinner{%
  \tfrac{\partial{^{#2}}#1}{\partial{#3^{#4}}\partial{#5^{#6}}}%
}}%
% \dpd[2]{f}{k} denotes the second partial derivative of f with respect to k
% The first letter d means "display style"
\providecommand{\dmd}[6]{\mathinner{%
  \dfrac{\partial{^{#2}}#1}{\partial{#3^{#4}}\partial{#5^{#6}}}%
}}%


% ordinary derivative - analogous to the partial derivative command
\providecommand{\od}[3][]{%
\ifinner%
  \tfrac{\dif{^{#1}}#2}{\dif{#3^{#1}}}%
\else%
  \dfrac{\dif{^{#1}}#2}{\dif{#3^{#1}}}%
\fi%
}%

\providecommand{\tod}[3][]{\mathinner{%
  \tfrac{\dif{^{#1}}#2}{\dif{#3^{#1}}}%
}}%
\providecommand{\dod}[3][]{\mathinner{%
  \dfrac{\dif{^{#1}}#2}{\dif{#3^{#1}}}%
}}%


% Totial differential
\newcommand{\td}[1]{\dif{#1}}

% Real value
\renewcommand{\Re}{\operatorname{Re}}

% Imaginary value
\renewcommand{\Im}{\operatorname{Im}}

% Transpose items
% \transp{A} renders A^T
\DeclareDocumentCommand{\transp}{m}{%
%  {#1}^{\intercal}%
%  {#1}^{\mkern-1.5mu\intercal}%
  {#1}^{\mkern-5mu\mathsf{T}}%
}

% Conjugate complex
\DeclareDocumentCommand{\conj}{o m}{%
  {#2}^{\overline{#1}}
}

% Hermitian conjugate of matrix
\DeclareDocumentCommand{\hermconj}{m m}{%
  {#1}^{\mkern-5mu\mathsf{H}}
}

% Element inverse (usually used for matrix inverse)
% \inv{A} renders A^{-1}
\DeclareDocumentCommand{\inv}{m}{%
  {#1}^{-1}%
}

% Dot-product
% \dotp{a}{b} => a \cdot b
\DeclareDocumentCommand{\dotp}{m m}{%
  {#1} \cdot {#2}
}

% Unit axis coordinate vector
% \evec{x} => \vect{e}_{x} => e_x
% \evec{z} renders \vect{e}_{z} => e_z
% \evec[k]{x} => \vect{k}_{x} => k_x
\DeclareDocumentCommand{\evec}{O{e} m}{%
  \vect{#1}_{\mc{#2}}%
}

% Declare atant a math operator rendering atan2
\DeclareMathOperator{\arctantwo}{atan2}

% Arcus tangent 2
% \atantwo{y}{x} renders atan2(y, x)
\NewDocumentCommand{\arctant}{m m}{%
  \arctantwo \left( #1, #2 \right)%
}%

% Math operator for the trace of matrix
\DeclareMathOperator{\trace}{tr}%

% Range of numbers
% \irange{m} renders i = 1, ..., m
% \irange{m}{j} renders j = 1, ..., m
% \irange[3]{m} renders i = 1, 3, ..., m
% \irange[3]{m}{j} renders j = 1, 3, ..., m
\NewDocumentCommand{\irange}{o m g}{%
  \def\runner{\IfValueTF{#3}{#3}{i}}%
%  \def\delta{#1}%
%  \def\ending{#2}%
  \IfValueTF{#1}{%
    {\runner = 1, #1, \ldots, #2}%
  }{%
    {\runner = 1, \ldots, #2}%
  }%
}%

% Well-scaled math subscripts
\DeclareDocumentCommand{\ms}{m}{%
  {\mbox{\textscale{0.6}{#1}}}%
}

% Proper math subscripts for textual indices like "std" or "coeff". Do not use for variable indices like "i" or "j"
\DeclareDocumentCommand{\mc}{m}{%
  {\ms{\text{#1}}}
}

% Rotation matrix without argument
\DeclareDocumentCommand{\rotm}{}{%
  \matr{R}%
}

% Rotation matrix R with argument with optional index
% \rot{\gamma} renders \matr{R} (\gamma)
% \rot[x]{\gamma} renders \matr{R}_x (\gamma)
\NewDocumentCommand{\rot}{o m}{%
  \IfValueTF{#1}{%
    \rotm_{#1} \left( #2 \right)%
  }{%
    \rotm \left( #2 \right)%
  }%
}

%\newcommand{\rot}[2]{\bm{R}_{#1}\left( #2 \right)}
\DeclareDocumentCommand{\rotx}{m}{%
  \rot[x]{#1}
}
\DeclareDocumentCommand{\roty}{m}{%
  \rot[y]{#1}
}
\DeclareDocumentCommand{\rotz}{m}{%
  \rot[z]{#1}
}

% Operator names for Imaginary and Real unit
\newcommand{\Imop}{\operatorname{Im}}
\newcommand{\Reop}{\operatorname{Re}}

% Imaginary unit i
\DeclareMathOperator{\imagu}{\mathrm{i}}
\DeclareDocumentCommand{\imgu}{}{%
  {\imagu\mkern1mu}%
}
